#:  -*- coding: utf-8 -*-
import datetime

from chanlun.exchange.exchange_db import ExchangeDB
from tqdm.auto import tqdm
import traceback
import time
import pandas as pd
from gm.api import *
from chanlun import config

"""
同步股票数据到数据库中

使用的是 掘金量化 API 获取
"""

# 可以直接提取数据，掘金终端需要打开，接口取数是通过网络请求的方式，效率一般，行情数据可通过subscribe订阅方式

# 如在远程执行，需要制定掘金终端地址  https://www.myquant.cn/docs/gm3_faq/154#b244aeed0032526e
set_serv_addr(config.GM_SERVER_ADDR)
# 设置token， 查看已有token ID,在用户-秘钥管理里获取
set_token(config.GM_TOKEN)

db_ex = ExchangeDB('a')

# 获取沪深 股票/基金/指数 代码
# fund_stocks = get_instruments(symbols=None, exchanges=['SHSE', 'SZSE'],
#                               sec_types=[SEC_TYPE_FUND])
#
# stock_stocks = get_instruments(symbols=None, exchanges=['SHSE', 'SZSE'],
#                                sec_types=[SEC_TYPE_STOCK])
# run_codes = ['SHSE.000001'] + [s['symbol'] for s in stock_stocks] + [s['symbol'] for s in fund_stocks if
#                                                                      s['symbol'][0:7] in ['SHSE.51', 'SZSE.15']]

# 指定要更新的股票列表
run_codes = ['SHSE.000001', 'SHSE.600519', 'SHSE.601398', 'SHSE.601939', 'SHSE.600941', 'SZSE.300750', 'SHSE.601288',
             'SHSE.601857', 'SHSE.601988', 'SHSE.600036', 'SHSE.601628', 'SHSE.601318', 'SZSE.002594', 'SZSE.000858',
             'SHSE.601088', 'SHSE.600900', 'SHSE.600028', 'SHSE.601658', 'SHSE.601888', 'SHSE.601012', 'SZSE.000333',
             'SHSE.603288', 'SHSE.600809', 'SHSE.601166', 'SHSE.601328', 'SHSE.601728', 'SZSE.000568', 'SZSE.300760',
             'SHSE.688981', 'SZSE.002714', 'SZSE.002415', 'SHSE.600309', 'SHSE.600030', 'SHSE.601633', 'SHSE.600188',
             'SZSE.300059', 'SZSE.000001', 'SHSE.600690', 'SZSE.002352', 'SZSE.002475', 'SHSE.601899', 'SZSE.300999',
             'SHSE.601998', 'SHSE.600438', 'SZSE.002304', 'SHSE.601225', 'SHSE.601816', 'SHSE.601319', 'SHSE.601668',
             'SHSE.600048', 'SHSE.600276', 'SHSE.603259', 'SHSE.600000', 'SZSE.002142', 'SHSE.600887', 'SZSE.000002',
             'SHSE.601919', 'SHSE.601601', 'SZSE.000651', 'SHSE.601066', 'SZSE.002466', 'SZSE.300015', 'SHSE.601995',
             'SHSE.600104', 'SHSE.601138', 'SHSE.600436', 'SZSE.002460', 'SZSE.300274', 'SHSE.600406', 'SZSE.300014',
             'SHSE.600905', 'SZSE.002812', 'SZSE.002371', 'SHSE.600585', 'SHSE.601818', 'SHSE.600016', 'SZSE.300124',
             'SHSE.601111', 'SZSE.002459', 'SZSE.002493', 'SHSE.688599', 'SZSE.000792', 'SZSE.002129', 'SHSE.600009',
             'SHSE.601898', 'SHSE.601238', 'SHSE.600600', 'SHSE.601766', 'SHSE.601390', 'SZSE.003816', 'SZSE.000625',
             'SZSE.300498', 'SZSE.000596', 'SZSE.300122', 'SZSE.002049', 'SHSE.600011', 'SHSE.603260', 'SHSE.600025',
             'SZSE.000725', 'SHSE.600346', 'SHSE.600760', 'SHSE.600031', 'SHSE.600018', 'SHSE.601211', 'SZSE.001979',
             'SHSE.688235', 'SHSE.601800', 'SHSE.600019', 'SHSE.600893', 'SHSE.603799', 'SHSE.600837', 'SZSE.000301',
             'SZSE.000776', 'SHSE.601985', 'SHSE.600150', 'SHSE.600029', 'SHSE.688303', 'SHSE.601688', 'SHSE.601669',
             'SHSE.600111', 'SHSE.600999', 'SHSE.600919', 'SZSE.000063', 'SHSE.601009', 'SHSE.600989', 'SHSE.600050',
             'SHSE.603993', 'SZSE.002050', 'SZSE.300896', 'SHSE.603392', 'SHSE.601127', 'SZSE.002179', 'SHSE.600660',
             'SHSE.601006', 'SZSE.002241', 'SHSE.603501', 'SZSE.000166', 'SHSE.601868', 'SHSE.601186', 'SHSE.688111',
             'SHSE.605117', 'SZSE.002311', 'SHSE.601881', 'SZSE.000708', 'SHSE.600115', 'SZSE.000538', 'SZSE.300316',
             'SZSE.000338', 'SZSE.002709', 'SHSE.600026', 'SHSE.600010', 'SHSE.600256', 'SHSE.603195', 'SZSE.300763',
             'SHSE.601169', 'SHSE.600089', 'SHSE.601336', 'SZSE.300751', 'SZSE.002736', 'SHSE.600703', 'SHSE.600196',
             'SZSE.000768', 'SHSE.601689', 'SHSE.601229', 'SZSE.000895', 'SHSE.600886', 'SHSE.600926', 'SHSE.603659',
             'SHSE.601989', 'SZSE.002230', 'SZSE.000877', 'SZSE.002920', 'SHSE.600015', 'SZSE.300450', 'SHSE.600547',
             'SHSE.600522', 'SHSE.688187', 'SHSE.600845', 'SHSE.601865', 'SZSE.002027', 'SHSE.601600', 'SZSE.300347',
             'SHSE.600795', 'SHSE.603833', 'SHSE.601808', 'SHSE.603806', 'SHSE.600233', 'SHSE.688012', 'SZSE.002271',
             'SZSE.300957', 'SHSE.600875', 'SZSE.000963', 'SHSE.600958', 'SHSE.603986', 'SHSE.601872', 'SHSE.601991',
             'SZSE.002001', 'SHSE.601727', 'SHSE.601788', 'SHSE.601916', 'SZSE.000876', 'SHSE.601618', 'SZSE.000733',
             'SHSE.600027', 'SHSE.600745', 'SHSE.688396', 'SZSE.002180', 'SHSE.601100', 'SHSE.603290', 'SZSE.000661',
             'SHSE.600426', 'SZSE.002938', 'SZSE.300759', 'SHSE.600588', 'SHSE.688363', 'SHSE.688385', 'SHSE.600570',
             'SHSE.601607', 'SZSE.300142', 'SHSE.600754', 'SHSE.688008', 'SZSE.300979', 'SZSE.000617', 'SHSE.601018',
             'SZSE.003022', 'SHSE.600085', 'SHSE.601877', 'SZSE.000983', 'SHSE.688032', 'SZSE.000425', 'SHSE.688063',
             'SZSE.002756', 'SHSE.600803', 'SZSE.002074', 'SZSE.300628', 'SHSE.601838', 'SHSE.601615', 'SHSE.600362',
             'SHSE.600674', 'SZSE.002410', 'SHSE.600176', 'SHSE.600741', 'SHSE.603185', 'SHSE.601901', 'SZSE.300919',
             'SZSE.000100', 'SHSE.603369', 'SHSE.605499', 'SHSE.601825', 'SHSE.600884', 'SHSE.688126', 'SHSE.601117',
             'SZSE.300769', 'SHSE.600383', 'SHSE.603606', 'SHSE.688122', 'SZSE.002821', 'SHSE.603613', 'SHSE.600460',
             'SZSE.002202', 'SHSE.600132', 'SZSE.000157', 'SZSE.002120', 'SHSE.601360', 'SHSE.600039', 'SZSE.000408',
             'SHSE.601377', 'SHSE.601699', 'SZSE.300661', 'SZSE.300782', 'SZSE.002648', 'SZSE.300433', 'SZSE.300408',
             'SZSE.001965', 'SZSE.300413', 'SZSE.002738', 'SHSE.600236', 'SHSE.688036', 'SHSE.600221', 'SZSE.000938',
             'SHSE.600918', 'SZSE.300496', 'SHSE.601021', 'SZSE.002240', 'SZSE.002013', 'SHSE.600765', 'SZSE.000723',
             'SHSE.688234', 'SZSE.300454', 'SZSE.002384', 'SHSE.600702', 'SHSE.688009', 'SHSE.600956', 'SHSE.603198',
             'SHSE.688180', 'SHSE.601155', 'SHSE.688082', 'SHSE.601799', 'SHSE.600348', 'SHSE.603605', 'SHSE.600096',
             'SZSE.300207', 'SHSE.600023', 'SZSE.000629', 'SHSE.600153', 'SHSE.601698', 'SHSE.603688', 'SHSE.603345',
             'SZSE.300699', 'SHSE.600487', 'SZSE.000786', 'SHSE.600606', 'SHSE.600332', 'SZSE.300033', 'SZSE.300390',
             'SZSE.002841', 'SZSE.000069', 'SHSE.600995', 'SZSE.002916', 'SHSE.688005', 'SZSE.300724', 'SZSE.002340',
             'SZSE.000799', 'SZSE.002236', 'SHSE.600141', 'SHSE.601077', 'SZSE.000933', 'SHSE.603899', 'SHSE.600584',
             'SHSE.603568', 'SZSE.002555', 'SHSE.600663', 'SZSE.000039', 'SHSE.600515', 'SZSE.002414', 'SHSE.688728',
             'SHSE.600219', 'SZSE.002532', 'SHSE.600061', 'SHSE.603486', 'SZSE.002601', 'SHSE.601880', 'SHSE.601878',
             'SHSE.600160', 'SHSE.600763', 'SHSE.600732', 'SHSE.600563', 'SHSE.688065', 'SZSE.002176', 'SHSE.600298',
             'SHSE.688777', 'SHSE.600418', 'SHSE.600985', 'SHSE.601866', 'SHSE.600377', 'SHSE.600885', 'SHSE.688516',
             'SHSE.600862', 'SHSE.600157', 'SZSE.002032', 'SHSE.600372', 'SZSE.300438', 'SHSE.601298', 'SZSE.002353',
             'SZSE.002945', 'SZSE.300073', 'SHSE.601236', 'SZSE.002252', 'SHSE.600871', 'SZSE.300003', 'SHSE.688538',
             'SZSE.002080', 'SHSE.600988', 'SZSE.300442', 'SZSE.300529', 'SHSE.600489', 'SHSE.600546', 'SZSE.000975',
             'SZSE.000800', 'SZSE.000738', 'SHSE.603019', 'SZSE.000807', 'SZSE.000519', 'SHSE.600801', 'SZSE.002385',
             'SZSE.300223', 'SHSE.600378', 'SZSE.000999', 'SZSE.002064', 'SHSE.600295', 'SZSE.002430', 'SZSE.002939',
             'SHSE.603885', 'SHSE.688390', 'SZSE.300604', 'SHSE.688819', 'SZSE.002244', 'SHSE.601216', 'SHSE.601233',
             'SZSE.300595', 'SHSE.688561', 'SHSE.688301', 'SHSE.603596', 'SHSE.600499', 'SHSE.601231', 'SZSE.002625',
             'SHSE.600688', 'SZSE.300601', 'SHSE.600161', 'SZSE.002056', 'SZSE.300012', 'SHSE.600549', 'SHSE.600004',
             'SZSE.002025', 'SZSE.002600', 'SHSE.603939', 'SHSE.600482', 'SZSE.002603', 'SZSE.002192', 'SHSE.605358',
             'SHSE.601108', 'SZSE.002007', 'SZSE.300144', 'SHSE.600183', 'SHSE.603868', 'SHSE.603816', 'SHSE.600685',
             'SHSE.603737', 'SHSE.601058', 'SHSE.601869', 'SHSE.603127', 'SHSE.600486', 'SZSE.000009', 'SZSE.002497',
             'SZSE.300776', 'SHSE.601555', 'SZSE.002409', 'SZSE.002078', 'SHSE.688536', 'SHSE.600779', 'SZSE.300285',
             'SHSE.600399', 'SHSE.688567', 'SZSE.000977', 'SHSE.600873', 'SHSE.600848', 'SHSE.600968', 'SZSE.000155',
             'SHSE.601666', 'SHSE.601696', 'SZSE.000959', 'SZSE.000883', 'SHSE.601001', 'SHSE.688778', 'SZSE.000703',
             'SHSE.601933', 'SZSE.300037', 'SZSE.002372', 'SHSE.603077', 'SZSE.002405', 'SZSE.002008', 'SHSE.688185',
             'SHSE.600352', 'SHSE.603893', 'SZSE.000987', 'SHSE.600177', 'SZSE.000893', 'SHSE.603456', 'SZSE.002422',
             'SZSE.002602', 'SHSE.601990', 'SHSE.600481', 'SHSE.600642', 'SHSE.600109', 'SZSE.000728', 'SZSE.000932',
             'SZSE.300748', 'SHSE.600733', 'SZSE.002028', 'SZSE.001872', 'SHSE.688779', 'SHSE.600021', 'SZSE.000783',
             'SZSE.000630', 'SZSE.300395', 'SZSE.002407', 'SHSE.688690', 'SZSE.000027', 'SZSE.300146', 'SHSE.600392',
             'SZSE.000513', 'SHSE.688099', 'SHSE.603517', 'SHSE.600497', 'SHSE.601598', 'SHSE.688220', 'SHSE.603658',
             'SHSE.601966', 'SZSE.300861', 'SHSE.603529', 'SHSE.603267', 'SZSE.002153', 'SHSE.688017', 'SHSE.600517',
             'SHSE.601456', 'SHSE.601636', 'SZSE.000066', 'SZSE.301029', 'SHSE.603882', 'SHSE.689009', 'SZSE.002791',
             'SHSE.688188', 'SHSE.603826', 'SZSE.002185', 'SZSE.300888', 'SZSE.000591', 'SZSE.002607', 'SHSE.603589',
             'SZSE.002568', 'SHSE.688772', 'SHSE.601992', 'SHSE.600705', 'SHSE.600518', 'SZSE.300832', 'SZSE.000683',
             'SHSE.600521', 'SZSE.000539', 'SHSE.600673', 'SHSE.600655', 'SHSE.603233', 'SZSE.000831', 'SZSE.000825',
             'SZSE.000785', 'SHSE.603876', 'SZSE.002673', 'SZSE.300850', 'SHSE.601958', 'SHSE.600859', 'SZSE.002831',
             'SHSE.600079', 'SZSE.301035', 'SHSE.603712', 'SZSE.300373', 'SHSE.688598', 'SHSE.600299', 'SHSE.601577',
             'SHSE.601156', 'SHSE.600863', 'SHSE.688116', 'SZSE.002865', 'SHSE.600350', 'SHSE.600536', 'SHSE.603305',
             'SZSE.002128', 'SHSE.688256', 'SZSE.300363', 'SZSE.000898', 'SZSE.002223', 'SZSE.300568', 'SZSE.000830',
             'SZSE.002294', 'SZSE.000729', 'SHSE.600038', 'SHSE.601717', 'SZSE.000762', 'SHSE.600816', 'SZSE.002624',
             'SZSE.002268', 'SHSE.600143', 'SHSE.688169', 'SZSE.000537', 'SHSE.688248', 'SZSE.000709', 'SZSE.000980',
             'SHSE.600415', 'SZSE.002299', 'SHSE.600032', 'SHSE.601158', 'SHSE.600927', 'SHSE.600416', 'SHSE.600338',
             'SHSE.600598', 'SZSE.300487', 'SHSE.601198', 'SHSE.600516', 'SHSE.603707', 'SHSE.600118', 'SHSE.601168',
             'SHSE.601975', 'SHSE.601162', 'SZSE.002966', 'SZSE.002472', 'SZSE.000937', 'SHSE.600369', 'SZSE.002507',
             'SZSE.002531', 'SZSE.002797', 'SZSE.300682', 'SHSE.601963', 'SHSE.600872', 'SZSE.300034', 'SHSE.600258',
             'SHSE.688105', 'SZSE.002850', 'SZSE.002030', 'SZSE.002761', 'SZSE.301071', 'SHSE.600906', 'SZSE.300118',
             'SZSE.002608', 'SZSE.002444', 'SHSE.603236', 'SHSE.601568', 'SZSE.002739', 'SHSE.601399', 'SZSE.300054',
             'SZSE.002518', 'SHSE.603160', 'SHSE.601777', 'SZSE.000958', 'SHSE.603156', 'SZSE.002557', 'SHSE.688276',
             'SZSE.000401', 'SZSE.002203', 'SHSE.600170', 'SZSE.000688', 'SZSE.002487', 'SHSE.601016', 'SHSE.688521',
             'SHSE.688707', 'SHSE.601179', 'SHSE.603786', 'SZSE.003035', 'SZSE.000012', 'SHSE.603565', 'SZSE.000553',
             'SHSE.600704', 'SZSE.300866', 'SZSE.300676', 'SZSE.000960', 'SZSE.300474', 'SHSE.600909', 'SZSE.002156',
             'SZSE.300357', 'SZSE.002541', 'SZSE.000516', 'SZSE.002508', 'SHSE.601928', 'SZSE.002312', 'SZSE.300251',
             'SHSE.600808', 'SHSE.600208', 'SZSE.002266', 'SHSE.601611', 'SZSE.002145', 'SZSE.002597', 'SHSE.600711',
             'SZSE.300666', 'SHSE.603129', 'SHSE.600166', 'SHSE.600483', 'SHSE.600578', 'SHSE.688686', 'SHSE.600390',
             'SZSE.000050', 'SZSE.002015', 'SZSE.002326', 'SHSE.600559', 'SHSE.603218', 'SHSE.600637', 'SZSE.002432',
             'SHSE.603713', 'SHSE.688006', 'SZSE.300308', 'SHSE.600916', 'SHSE.600456', 'SZSE.002152', 'SHSE.600998',
             'SZSE.002399', 'SHSE.688107', 'SHSE.600325', 'SHSE.600970', 'SHSE.600582', 'SHSE.603026', 'SHSE.688200',
             'SZSE.002906', 'SZSE.002683', 'SHSE.603348', 'SZSE.000818', 'SHSE.601128', 'SZSE.000423', 'SHSE.688425',
             'SZSE.002389', 'SZSE.002484', 'SZSE.002617', 'SZSE.000869', 'SZSE.002984', 'SHSE.600583', 'SHSE.601139',
             'SHSE.600641', 'SZSE.002463', 'SZSE.000810', 'SHSE.688520', 'SHSE.601228', 'SHSE.601212', 'SZSE.002936',
             'SHSE.601997', 'SZSE.001213', 'SHSE.601828', 'SZSE.000887', 'SHSE.600057', 'SHSE.600977', 'SZSE.002926',
             'SZSE.300068', 'SHSE.688161', 'SZSE.002585', 'SHSE.600612', 'SHSE.600315', 'SHSE.601106', 'SHSE.600699',
             'SZSE.002948', 'SHSE.600008', 'SHSE.600098', 'SHSE.605111', 'SZSE.002506', 'SHSE.600827', 'SHSE.688499',
             'SZSE.002690', 'SHSE.688202', 'SHSE.600596', 'SZSE.002408', 'SZSE.300257', 'SZSE.300777', 'SHSE.600566',
             'SZSE.000988', 'SHSE.688700', 'SHSE.600739', 'SZSE.002468', 'SZSE.003031', 'SZSE.002439', 'SHSE.601665',
             'SHSE.600246', 'SZSE.000998', 'SZSE.300775', 'SZSE.000564', 'SHSE.603678', 'SHSE.600500', 'SZSE.300260',
             'SZSE.000739', 'SHSE.600511', 'SHSE.600380', 'SZSE.300726', 'SHSE.601677', 'SZSE.002465', 'SHSE.603858',
             'SHSE.600095', 'SHSE.688019', 'SHSE.603087', 'SHSE.688050', 'SZSE.301177', 'SHSE.603179', 'SZSE.002595',
             'SHSE.603317', 'SHSE.603338', 'SZSE.002500', 'SHSE.688139', 'SHSE.688556', 'SZSE.002505', 'SHSE.600398',
             'SHSE.600271', 'SHSE.688037', 'SHSE.600395', 'SZSE.002456', 'SHSE.600056', 'SZSE.002092', 'SHSE.600777',
             'SHSE.601118', 'SHSE.603355', 'SZSE.300432', 'SZSE.000750', 'SHSE.600062', 'SZSE.301155', 'SZSE.300803',
             'SZSE.002024', 'SHSE.600297', 'SZSE.002653', 'SHSE.688739', 'SHSE.601908', 'SHSE.601028', 'SZSE.000581',
             'SZSE.001914', 'SZSE.300244', 'SZSE.000902', 'SHSE.603650', 'SHSE.600548', 'SHSE.600935', 'SHSE.601952',
             'SHSE.603444', 'SZSE.000400', 'SZSE.300070', 'SZSE.000636', 'SHSE.603056', 'SHSE.601099', 'SZSE.000875',
             'SHSE.601098', 'SHSE.600116', 'SZSE.000878', 'SZSE.002138', 'SHSE.688776', 'SZSE.002065', 'SZSE.300761',
             'SHSE.688002', 'SZSE.300346', 'SHSE.603599', 'SZSE.000970', 'SHSE.600562', 'SZSE.002245', 'SHSE.601965',
             'SHSE.600282', 'SHSE.601369', 'SHSE.600320', 'SZSE.300428', 'SZSE.002250', 'SHSE.600316', 'SZSE.002041',
             'SHSE.600867', 'SHSE.600123', 'SHSE.603228', 'SZSE.000021', 'SZSE.000547', 'SHSE.603883', 'SHSE.600179',
             'SZSE.300679', 'SHSE.600895', 'SZSE.300035', 'SHSE.600329', 'SHSE.600675', 'SZSE.300393', 'SHSE.600773',
             'SHSE.600879', 'SHSE.603866', 'SHSE.600528', 'SZSE.301039', 'SZSE.002335', 'SZSE.300627', 'SZSE.300821',
             'SHSE.601375', 'SHSE.603733', 'SZSE.300593', 'SZSE.002044', 'SZSE.000559', 'SHSE.600022', 'SHSE.600610',
             'SZSE.002436', 'SZSE.300633', 'SZSE.300558', 'SHSE.600339', 'SZSE.002958', 'SHSE.603098', 'SHSE.603588',
             'SHSE.600066', 'SZSE.000060', 'SHSE.600277', 'SZSE.002747', 'SHSE.600820', 'SHSE.603728', 'SZSE.002461',
             'SHSE.600248', 'SHSE.601702', 'SHSE.600580', 'SZSE.000402', 'SHSE.600529', 'SZSE.000623', 'SHSE.603906',
             'SHSE.605090', 'SHSE.688333', 'SZSE.002155', 'SZSE.000927', 'SHSE.600933', 'SZSE.002273', 'SHSE.600740',
             'SHSE.601921', 'SZSE.002318', 'SHSE.600323', 'SHSE.600063', 'SZSE.001203', 'SHSE.601567', 'SHSE.601326',
             'SZSE.002036', 'SHSE.688798', 'SZSE.002558', 'SZSE.000686', 'SZSE.300294', 'SZSE.300376', 'SHSE.603505',
             'SZSE.000627', 'SHSE.601000', 'SHSE.600131', 'SZSE.002517', 'SHSE.600498', 'SHSE.603025', 'SZSE.002157',
             'SHSE.600328', 'SZSE.000921', 'SHSE.600764', 'SZSE.300088', 'SZSE.002010', 'SZSE.300001', 'SZSE.000930',
             'SHSE.600428', 'SHSE.688083', 'SZSE.002985', 'SHSE.600110', 'SHSE.600877', 'SHSE.600737', 'SHSE.600199',
             'SZSE.000031', 'SZSE.300383', 'SZSE.300457', 'SHSE.601608', 'SZSE.002429', 'SZSE.300026', 'SZSE.000860',
             'SZSE.002572', 'SZSE.301090', 'SHSE.600657', 'SHSE.603279', 'SZSE.002698', 'SZSE.000598', 'SZSE.300418',
             'SZSE.000429', 'SZSE.300101', 'SHSE.600389', 'SHSE.688206', 'SZSE.000981', 'SHSE.688696', 'SHSE.688800',
             'SHSE.600928', 'SHSE.688232', 'SZSE.000422', 'SZSE.300618', 'SZSE.002423', 'SHSE.600901', 'SHSE.688568',
             'SZSE.002151', 'SHSE.603225', 'SZSE.000778', 'SZSE.000967', 'SZSE.000935', 'SZSE.000488', 'SHSE.600882',
             'SZSE.002670', 'SZSE.002183', 'SHSE.600959', 'SHSE.600167', 'SZSE.002411', 'SZSE.002258', 'SHSE.688680',
             'SHSE.688559', 'SZSE.002978', 'SZSE.300741', 'SZSE.000032', 'SZSE.002610', 'SHSE.601187', 'SHSE.601222',
             'SHSE.688198', 'SHSE.688639', 'SHSE.600007', 'SZSE.300296', 'SHSE.600586', 'SZSE.300910', 'SZSE.002643',
             'SZSE.002182', 'SHSE.603379', 'SHSE.600535', 'SZSE.300136', 'SHSE.600755', 'SZSE.002324', 'SHSE.603363',
             'SZSE.300298', 'SHSE.601005', 'SHSE.600623', 'SHSE.688268', 'SZSE.002851', 'SZSE.002925', 'SHSE.600060',
             'SHSE.601969', 'SHSE.688055', 'SHSE.600597', 'SZSE.002262', 'SZSE.002139', 'SHSE.600100', 'SZSE.300115',
             'SZSE.002091', 'SZSE.002705', 'SHSE.605123', 'SZSE.002773', 'SHSE.600595', 'SHSE.600507', 'SZSE.000657',
             'SHSE.603489', 'SZSE.300024', 'SZSE.300623', 'SZSE.002706', 'SHSE.600126', 'SZSE.300009', 'SHSE.605589',
             'SZSE.002291', 'SHSE.601333', 'SZSE.002866', 'SHSE.603612', 'SZSE.300253', 'SZSE.300855', 'SZSE.002191',
             'SHSE.600259', 'SHSE.600055', 'SZSE.000062', 'SZSE.002727', 'SHSE.600707', 'SHSE.600967', 'SZSE.002216',
             'SZSE.002402', 'SZSE.002171', 'SZSE.300171', 'SZSE.000089', 'SZSE.300083', 'SZSE.300339', 'SZSE.300343',
             'SZSE.002544', 'SHSE.688208', 'SZSE.002498', 'SZSE.300747', 'SZSE.300820', 'SZSE.300587', 'SZSE.301078',
             'SZSE.002373', 'SHSE.605296', 'SHSE.688289', 'SHSE.600195', 'SZSE.301069', 'SZSE.000415', 'SHSE.600273',
             'SHSE.605507', 'SZSE.000567', 'SHSE.603997', 'SZSE.002011', 'SHSE.601778', 'SHSE.603308', 'SHSE.600151',
             'SHSE.603027', 'SHSE.603128', 'SZSE.000761', 'SHSE.688110', 'SHSE.601019', 'SHSE.600603', 'SZSE.000966',
             'SHSE.600648', 'SZSE.300725', 'SZSE.002511', 'SHSE.603005', 'SZSE.300458', 'SHSE.688408', 'SHSE.600409',
             'SZSE.002221', 'SHSE.600216', 'SHSE.688001', 'SZSE.000498', 'SZSE.000582', 'SHSE.600876', 'SZSE.002563',
             'SZSE.300672', 'SZSE.000550', 'SHSE.601718', 'SZSE.002100', 'SZSE.000049', 'SZSE.002226', 'SHSE.600771',
             'SZSE.300482', 'SZSE.301050', 'SHSE.600478', 'SHSE.688066', 'SHSE.600129', 'SZSE.000672', 'SZSE.300677',
             'SZSE.000546', 'SHSE.688383', 'SZSE.002745', 'SHSE.603927', 'SHSE.603995', 'SZSE.300613', 'SZSE.000951',
             'SZSE.000403', 'SZSE.300596', 'SHSE.600532', 'SZSE.002539', 'SZSE.000997', 'SHSE.603033', 'SZSE.000035',
             'SZSE.002124', 'SHSE.688388', 'SHSE.603398', 'SHSE.600955', 'SZSE.000156', 'SZSE.300973', 'SZSE.002249',
             'SHSE.600782', 'SZSE.002534', 'SZSE.002158', 'SHSE.600171', 'SHSE.600120', 'SHSE.688298', 'SHSE.603690',
             'SHSE.600155', 'SHSE.600639', 'SHSE.603638', 'SHSE.688608', 'SHSE.603000', 'SHSE.600869', 'SZSE.002019',
             'SHSE.600064', 'SHSE.688029', 'SHSE.601137', 'SZSE.300382', 'SHSE.688676', 'SHSE.603979', 'SHSE.600452',
             'SZSE.300476', 'SZSE.002081', 'SZSE.002101', 'SZSE.000059', 'SHSE.600662', 'SHSE.603919', 'SHSE.601512',
             'SZSE.002867', 'SZSE.002219', 'SZSE.301047', 'SZSE.002701', 'SHSE.688789', 'SHSE.688192', 'SZSE.300638',
             'SHSE.601918', 'SZSE.300755', 'SHSE.603477', 'SHSE.600172', 'SZSE.002003', 'SZSE.300567', 'SHSE.600929',
             'SHSE.601068', 'SZSE.000990', 'SZSE.300182', 'SZSE.002895', 'SHSE.600917', 'SHSE.603730', 'SZSE.002131',
             'SZSE.000028', 'SZSE.300058', 'SHSE.600667', 'SHSE.600400', 'SZSE.300841', 'SHSE.600006', 'SHSE.600403',
             'SHSE.688131', 'SHSE.688617', 'SZSE.002110', 'SZSE.002911', 'SHSE.600997', 'SZSE.002840', 'SHSE.603063',
             'SHSE.600363', 'SZSE.002549', 'SZSE.002832', 'SZSE.300203', 'SZSE.002085', 'SZSE.002626', 'SHSE.601107',
             'SZSE.002088', 'SHSE.600839', 'SZSE.002967', 'SHSE.603043', 'SZSE.000656', 'SZSE.003021', 'SHSE.600618',
             'SHSE.600335', 'SHSE.600388', 'SHSE.603223', 'SHSE.600267', 'SHSE.688278', 'SZSE.000016', 'SHSE.601258',
             'SHSE.600718', 'SHSE.603008', 'SZSE.002254', 'SZSE.002006', 'SHSE.600435', 'SHSE.603595', 'SHSE.601811',
             'SHSE.600717', 'SZSE.300827', 'SZSE.000712', 'SHSE.600621', 'SZSE.002002', 'SZSE.000563', 'SZSE.300767',
             'SHSE.600508', 'SHSE.600373', 'SZSE.002434', 'SZSE.300773', 'SZSE.300327', 'SHSE.688518', 'SZSE.002960',
             'SZSE.002212', 'SHSE.688262', 'SHSE.600835', 'SZSE.002068', 'SHSE.600370', 'SZSE.002416', 'SHSE.600012',
             'SZSE.300017', 'SZSE.000756', 'SZSE.000821', 'SZSE.000426', 'SHSE.600163', 'SZSE.002901', 'SHSE.600313',
             'SHSE.600376', 'SHSE.600206', 'SZSE.300737', 'SHSE.600682', 'SHSE.600556', 'SHSE.600776', 'SZSE.300894',
             'SHSE.688366', 'SHSE.601678', 'SZSE.000913', 'SZSE.002287', 'SHSE.600888', 'SZSE.300459', 'SHSE.605369',
             'SHSE.601519', 'SHSE.600841', 'SHSE.600567', 'SZSE.003039', 'SZSE.002195', 'SHSE.600330', 'SZSE.002127',
             'SZSE.002146', 'SZSE.002204', 'SZSE.002810', 'SHSE.603515', 'SHSE.603567', 'SZSE.000528', 'SHSE.603032',
             'SZSE.002837', 'SHSE.600197', 'SZSE.000034', 'SHSE.688023', 'SZSE.000540', 'SHSE.601827', 'SHSE.600787',
             'SZSE.000088', 'SHSE.605333', 'SHSE.603396', 'SHSE.688167', 'SHSE.605376', 'SZSE.300481', 'SZSE.002320',
             'SHSE.603693', 'SHSE.603298', 'SHSE.600225', 'SZSE.300332', 'SZSE.002581', 'SZSE.301015', 'SZSE.002121',
             'SZSE.002281', 'SHSE.601069', 'SHSE.601015', 'SHSE.603985', 'SZSE.002396', 'SZSE.002453', 'SZSE.002645',
             'SZSE.000543', 'SZSE.002242', 'SZSE.300502', 'SZSE.002053', 'SHSE.601126', 'SHSE.688033', 'SHSE.603915',
             'SHSE.600305', 'SHSE.600746', 'SHSE.688269', 'SHSE.600366', 'SZSE.002004', 'SZSE.002928', 'SZSE.002930',
             'SZSE.002237', 'SHSE.600908', 'SHSE.688315', 'SHSE.603938', 'SZSE.002061', 'SZSE.000090', 'SZSE.300394',
             'SZSE.000767', 'SZSE.300856', 'SZSE.002545', 'SZSE.000413', 'SHSE.688239', 'SHSE.603989', 'SZSE.000690',
             'SHSE.600996', 'SHSE.600037', 'SHSE.688097', 'SHSE.600340', 'SZSE.002125', 'SHSE.688526', 'SZSE.300772',
             'SZSE.002314', 'SZSE.002665', 'SZSE.002847', 'SHSE.600734', 'SHSE.688733', 'SHSE.601609', 'SHSE.600770',
             'SHSE.688007', 'SZSE.300093', 'SZSE.300261', 'SZSE.300224', 'SHSE.601311', 'SZSE.300630', 'SZSE.002839',
             'SHSE.600307', 'SZSE.300456', 'SZSE.002317', 'SHSE.601038', 'SZSE.000957', 'SHSE.601101', 'SZSE.300674',
             'SHSE.688106', 'SHSE.603719', 'SZSE.002993', 'SZSE.002099', 'SZSE.002048', 'SZSE.002537', 'SHSE.603297',
             'SZSE.000839', 'SHSE.600477', 'SHSE.603766', 'SZSE.300080', 'SHSE.600821', 'SZSE.000736', 'SZSE.000718',
             'SZSE.002368', 'SZSE.300409', 'SZSE.000631', 'SZSE.300072', 'SZSE.300443', 'SHSE.688133', 'SZSE.301031',
             'SHSE.601528', 'SHSE.601860', 'SZSE.000685', 'SZSE.000420', 'SHSE.601200', 'SHSE.600575', 'SZSE.000829',
             'SZSE.300109', 'SZSE.002051', 'SHSE.600572', 'SZSE.300416', 'SHSE.603171', 'SHSE.603871', 'SZSE.300401',
             'SHSE.603055', 'SHSE.600864', 'SHSE.600728', 'SHSE.688356', 'SHSE.688088', 'SHSE.600185', 'SHSE.603229',
             'SHSE.600075', 'SZSE.002079', 'SHSE.688533', 'SZSE.300185', 'SZSE.300233', 'SZSE.300887', 'SZSE.300463',
             'SHSE.600604', 'SZSE.300087', 'SHSE.601886', 'SHSE.601208', 'SZSE.002675', 'SZSE.002793', 'SHSE.603583',
             'SHSE.603399', 'SHSE.688016', 'SHSE.603306', 'SZSE.300406', 'SZSE.000961', 'SZSE.300671', 'SHSE.600812',
             'SHSE.603566', 'SHSE.688575', 'SZSE.000828', 'SHSE.603100', 'SZSE.301080', 'SHSE.603197', 'SHSE.688123',
             'SHSE.603393', 'SHSE.605008', 'SHSE.600811', 'SZSE.000517', 'SZSE.002612', 'SZSE.002897', 'SHSE.688190',
             'SZSE.000682', 'SHSE.603039', 'SZSE.300398', 'SZSE.300133', 'SHSE.600649', 'SZSE.000555', 'SHSE.600963',
             'SZSE.300188', 'SHSE.601388', 'SHSE.603169', 'SHSE.688091', 'SZSE.002737', 'SZSE.002567', 'SZSE.300236',
             'SZSE.000410', 'SHSE.601882', 'SZSE.300586', 'SZSE.002807', 'SZSE.300811', 'SZSE.300217', 'SHSE.601330',
             'SZSE.300415', 'SZSE.002818', 'SZSE.002859', 'SZSE.000758', 'SZSE.002126', 'SZSE.002243', 'SHSE.603888',
             'SZSE.002726', 'SZSE.000552', 'SHSE.600058', 'SHSE.600823', 'SZSE.301089', 'SHSE.600966', 'SHSE.603071',
             'SZSE.300687', 'SZSE.002932', 'SHSE.600312', 'SHSE.688100', 'SHSE.600446', 'SHSE.601619', 'SHSE.601801',
             'SZSE.300199', 'SZSE.000065', 'SZSE.300655', 'SZSE.002390', 'SHSE.600072', 'SZSE.002163', 'SZSE.000899',
             'SHSE.600850', 'SZSE.002063', 'SZSE.000737', 'SZSE.002946', 'SZSE.000158', 'SZSE.002815', 'SHSE.603323',
             'SZSE.002440', 'SZSE.000968', 'SZSE.000503', 'SZSE.002965', 'SZSE.002426', 'SZSE.300379', 'SZSE.002805',
             'SZSE.300451', 'SZSE.300119', 'SZSE.300168', 'SZSE.000061', 'SZSE.002302', 'SHSE.600550', 'SZSE.002876',
             'SZSE.000719', 'SHSE.600577', 'SZSE.002458', 'SHSE.600775', 'SHSE.600971', 'SHSE.688196', 'SHSE.603069',
             'SHSE.600459', 'SZSE.002556', 'SHSE.600874', 'SHSE.688660', 'SHSE.603181', 'SZSE.002881', 'SHSE.603212',
             'SZSE.002424', 'SZSE.002349', 'SHSE.600635', 'SHSE.600903', 'SHSE.600017', 'SZSE.002267', 'SZSE.002838',
             'SZSE.002233', 'SZSE.002276', 'SHSE.600252', 'SZSE.003012', 'SZSE.000727', 'SHSE.600266', 'SHSE.600201',
             'SHSE.600078', 'SHSE.600502', 'SZSE.002190', 'SZSE.300685', 'SHSE.688578', 'SHSE.603983', 'SZSE.002075',
             'SHSE.600491', 'SZSE.300525', 'SZSE.002201', 'SZSE.300712', 'SHSE.605099', 'SHSE.603666', 'SHSE.601163',
             'SZSE.000025', 'SHSE.688339', 'SHSE.600750', 'SZSE.002635', 'SHSE.601003', 'SHSE.603327', 'SZSE.300212',
             'SHSE.600643', 'SZSE.300166', 'SZSE.000595', 'SHSE.603113', 'SZSE.301018', 'SHSE.600783', 'SHSE.605020',
             'SZSE.000755', 'SZSE.000915', 'SZSE.000600', 'SHSE.603301', 'SHSE.688596', 'SZSE.002941', 'SHSE.688586',
             'SHSE.601968', 'SHSE.605399', 'SZSE.300869', 'SHSE.688677', 'SHSE.600420', 'SZSE.000671', 'SHSE.605116',
             'SHSE.603619', 'SHSE.603337', 'SHSE.600729', 'SHSE.600993', 'SHSE.688505', 'SHSE.601686', 'SHSE.600818',
             'SZSE.000029', 'SHSE.688321', 'SZSE.301060', 'SHSE.605198', 'SZSE.003040', 'SHSE.603609', 'SZSE.300953',
             'SZSE.000078', 'SZSE.002332', 'SZSE.002703', 'SHSE.600810', 'SHSE.600720', 'SZSE.000048', 'SZSE.300077',
             'SZSE.000572', 'SZSE.300696', 'SZSE.002239', 'SHSE.600691', 'SZSE.002514', 'SHSE.605168', 'SZSE.000848',
             'SZSE.002217', 'SZSE.000525', 'SHSE.603300', 'SHSE.601339', 'SZSE.001896', 'SHSE.600422', 'SZSE.002060',
             'SZSE.300138', 'SHSE.600860', 'SZSE.000541', 'SHSE.603299', 'SZSE.002038', 'SZSE.002135', 'SHSE.605339',
             'SHSE.600696', 'SHSE.603053', 'SZSE.002123', 'SHSE.600223', 'SZSE.300653', 'SZSE.000811', 'SZSE.300768',
             'SZSE.000912', 'SHSE.600651', 'SZSE.002583', 'SZSE.002724', 'SZSE.002293', 'SZSE.000030', 'SZSE.002077',
             'SZSE.300337', 'SZSE.300358', 'SZSE.000982', 'SZSE.002481', 'SHSE.603010', 'SZSE.000837', 'SHSE.688148',
             'SZSE.002108', 'SZSE.002913', 'SHSE.688377', 'SZSE.300323', 'SHSE.688266', 'SHSE.688630', 'SZSE.000950',
             'SZSE.300833', 'SHSE.603123', 'SZSE.002489', 'SHSE.600059', 'SHSE.688553', 'SHSE.601606', 'SZSE.002130',
             'SZSE.000969', 'SZSE.000019', 'SZSE.002386', 'SZSE.300348', 'SHSE.603639', 'SZSE.002149', 'SZSE.300475',
             'SZSE.002387', 'SZSE.300565', 'SHSE.688311', 'SHSE.600169', 'SZSE.002274', 'SHSE.601949', 'SHSE.600602',
             'SHSE.600587', 'SZSE.300681', 'SZSE.002543', 'SHSE.600094', 'SHSE.600633', 'SZSE.300735', 'SHSE.688560',
             'SZSE.300315', 'SZSE.002891', 'SZSE.002034', 'SZSE.002759', 'SZSE.002987', 'SHSE.601279', 'SZSE.002214',
             'SZSE.002573', 'SHSE.600851', 'SHSE.600158', 'SZSE.300799', 'SZSE.000501', 'SHSE.600211', 'SHSE.600198',
             'SZSE.300990', 'SHSE.600645', 'SZSE.002323', 'SHSE.603877', 'SHSE.603187', 'SHSE.688183', 'SZSE.300569',
             'SHSE.600138', 'SHSE.688336', 'SZSE.002959', 'SHSE.603103', 'SZSE.002020', 'SHSE.605222', 'SHSE.600523',
             'SHSE.603035', 'SHSE.600269', 'SHSE.688711', 'SZSE.300116', 'SZSE.300702', 'SZSE.300229', 'SHSE.600744',
             'SHSE.605183', 'SZSE.002057', 'SZSE.300470', 'SHSE.601890', 'SHSE.600496', 'SHSE.600084', 'SZSE.003038',
             'SZSE.300639', 'SZSE.002538', 'SZSE.002031', 'SHSE.600226', 'SHSE.605365', 'SHSE.601020', 'SZSE.002102',
             'SZSE.002768', 'SZSE.002356', 'SZSE.300765', 'SZSE.002819', 'SZSE.000681', 'SHSE.601515', 'SZSE.300002',
             'SZSE.301073', 'SHSE.600033', 'SZSE.002275', 'SHSE.605366', 'SHSE.688075', 'SHSE.600620', 'SHSE.603800',
             'SHSE.600054', 'SZSE.002166', 'SHSE.600230', 'SZSE.301058', 'SZSE.000923', 'SHSE.600881', 'SZSE.300036',
             'SZSE.000650', 'SZSE.300806', 'SZSE.002351', 'SZSE.002929', 'SHSE.603219', 'SZSE.002261', 'SZSE.000795',
             'SZSE.000560', 'SZSE.301101', 'SHSE.603556', 'SHSE.600475', 'SHSE.688166', 'SHSE.603636', 'SZSE.300151',
             'SZSE.002382', 'SZSE.301180', 'SZSE.300208', 'SZSE.002206', 'SHSE.603303', 'SZSE.300573', 'SZSE.002782',
             'SZSE.002132', 'SHSE.600461', 'SHSE.603920', 'SHSE.688318', 'SZSE.000717', 'SHSE.603067', 'SHSE.601011',
             'SZSE.300762', 'SHSE.600761', 'SHSE.600710', 'SZSE.000735', 'SZSE.000789', 'SZSE.000557', 'SZSE.300284',
             'SZSE.002639', 'SHSE.603855', 'SHSE.688177', 'SHSE.688665', 'SHSE.688233', 'SZSE.000885', 'SZSE.300041',
             'SHSE.600490', 'SZSE.300602', 'SZSE.300065', 'SZSE.000603', 'SZSE.300113', 'SHSE.603277', 'SZSE.002741',
             'SZSE.300783', 'SHSE.603881', 'SZSE.002292', 'SHSE.600510', 'SHSE.603227', 'SZSE.300497', 'SHSE.600557',
             'SZSE.002501', 'SZSE.002378', 'SZSE.002746', 'SHSE.600210', 'SHSE.688157', 'SZSE.002755', 'SHSE.603060',
             'SZSE.002677', 'SHSE.603801', 'SHSE.603358', 'SHSE.688601', 'SHSE.688317', 'SHSE.688212', 'SHSE.688236',
             'SZSE.000801', 'SZSE.300770', 'SZSE.002218', 'SZSE.002174', 'SZSE.002400', 'SZSE.001696', 'SHSE.600939',
             'SHSE.603916', 'SZSE.000906', 'SZSE.000928', 'SZSE.000822', 'SZSE.002419', 'SHSE.600180', 'SHSE.600617',
             'SZSE.000612', 'SHSE.601588', 'SHSE.603013', 'SZSE.002950', 'SHSE.688636', 'SZSE.002651', 'SHSE.600987',
             'SHSE.688112', 'SHSE.605599', 'SZSE.300693', 'SHSE.603668', 'SHSE.600353', 'SZSE.002488', 'SZSE.000534',
             'SZSE.300075', 'SZSE.002824', 'SZSE.300660', 'SZSE.000989', 'SZSE.002678', 'SHSE.600751', 'SHSE.688027',
             'SHSE.600458', 'SHSE.688128', 'SZSE.002516', 'SHSE.600190', 'SHSE.600251', 'SZSE.300008', 'SHSE.600073',
             'SZSE.002550', 'SZSE.000058', 'SHSE.688658', 'SHSE.688127', 'SZSE.001201', 'SZSE.002059', 'SHSE.600552',
             'SZSE.002270', 'SZSE.002646', 'SZSE.000976', 'SHSE.688625', 'SZSE.300369', 'SHSE.600611', 'SHSE.600640',
             'SZSE.000676', 'SZSE.000620', 'SHSE.600429', 'SHSE.688330', 'SZSE.000881', 'SZSE.300893', 'SHSE.600125',
             'SZSE.002047', 'SZSE.000791', 'SHSE.600480', 'SZSE.002470', 'SZSE.300125', 'SZSE.300518', 'SHSE.688766',
             'SZSE.002097', 'SZSE.002588', 'SHSE.601900', 'SHSE.688186', 'SHSE.600121', 'SZSE.300942', 'SHSE.603466',
             'SZSE.002169', 'SZSE.000813', 'SZSE.300079', 'SHSE.603587', 'SZSE.000665', 'SZSE.300197', 'SZSE.300005',
             'SZSE.002046', 'SZSE.300319', 'SZSE.002307', 'SZSE.002428', 'SZSE.002280', 'SHSE.600757', 'SZSE.000597',
             'SZSE.300027', 'SHSE.600360', 'SHSE.600828', 'SZSE.000726', 'SHSE.603665', 'SZSE.300662', 'SHSE.600780',
             'SZSE.002681', 'SZSE.002733', 'SZSE.300057', 'SZSE.000524', 'SZSE.300180', 'SZSE.002413', 'SHSE.600106',
             'SHSE.688222', 'SZSE.301096', 'SZSE.000720', 'SHSE.600537', 'SZSE.002023', 'SHSE.688151', 'SHSE.688162',
             'SZSE.301087', 'SHSE.688300', 'SZSE.002697', 'SHSE.688003', 'SHSE.605077', 'SHSE.600020', 'SHSE.603698',
             'SHSE.603936', 'SZSE.002996', 'SHSE.605555', 'SZSE.002285', 'SZSE.300723', 'SHSE.603118', 'SZSE.300360',
             'SZSE.002334', 'SHSE.600664', 'SZSE.002957', 'SZSE.002009', 'SHSE.603366', 'SZSE.000917', 'SZSE.300873',
             'SHSE.603708', 'SZSE.300082', 'SZSE.000901', 'SHSE.600217', 'SZSE.300179', 'SHSE.688018', 'SZSE.000680',
             'SZSE.300527', 'SHSE.688508', 'SHSE.600581', 'SZSE.002043', 'SZSE.300055', 'SHSE.603896', 'SZSE.000046',
             'SZSE.003009', 'SZSE.300129', 'SHSE.600231', 'SHSE.600619', 'SHSE.603718', 'SHSE.688022', 'SHSE.603105',
             'SHSE.605005', 'SZSE.000670', 'SZSE.300085', 'SZSE.002884', 'SZSE.002446', 'SHSE.600053', 'SHSE.603256',
             'SHSE.600433', 'SZSE.300256', 'SZSE.000042', 'SZSE.002623', 'SZSE.002540', 'SHSE.600984', 'SZSE.300019',
             'SZSE.002935', 'SHSE.605108', 'SHSE.603901', 'SZSE.300206', 'SZSE.300982', 'SHSE.688621', 'SZSE.300969',
             'SHSE.600381', 'SHSE.603110', 'SHSE.603987', 'SHSE.603112', 'SZSE.000008', 'SHSE.600285', 'SZSE.300663',
             'SHSE.603429', 'SHSE.600713', 'SZSE.300825', 'SHSE.603328', 'SZSE.000819', 'SHSE.605338', 'SZSE.002589',
             'SHSE.601226', 'SHSE.600308', 'SHSE.600152', 'SHSE.600162', 'SHSE.605286', 'SHSE.600569', 'SZSE.002716',
             'SHSE.688305', 'SZSE.300792', 'SHSE.600748', 'SZSE.002375', 'SZSE.301017', 'SHSE.600986', 'SZSE.002194',
             'SZSE.300191', 'SZSE.300364', 'SZSE.300718', 'SZSE.002961', 'SZSE.003013', 'SHSE.603680', 'SZSE.300170',
             'SZSE.300267', 'SHSE.688513', 'SZSE.002045', 'SHSE.600278', 'SZSE.002210', 'SZSE.301168', 'SZSE.000900',
             'SZSE.300131', 'SZSE.002992', 'SHSE.600742', 'SZSE.300232', 'SHSE.603959', 'SHSE.600975', 'SZSE.000722',
             'SZSE.002491', 'SHSE.603155', 'SZSE.002918', 'SHSE.688087', 'SZSE.300320', 'SZSE.300263', 'SHSE.688389',
             'SHSE.600108', 'SZSE.000544', 'SZSE.002667', 'SHSE.600981', 'SHSE.603511', 'SHSE.600609', 'SHSE.605337',
             'SZSE.002801', 'SHSE.603217', 'SHSE.600525', 'SZSE.000852', 'SZSE.002039', 'SHSE.600973', 'SZSE.002208',
             'SHSE.603315', 'SZSE.300581', 'SZSE.300053', 'SZSE.002329', 'SZSE.002222', 'SZSE.300619', 'SZSE.002729',
             'SHSE.688085', 'SHSE.688345', 'SZSE.002037', 'SHSE.603213', 'SHSE.605011', 'SZSE.002283', 'SHSE.688176',
             'SHSE.600509', 'SHSE.605368', 'SZSE.300598', 'SZSE.002765', 'SZSE.002637', 'SHSE.603533', 'SHSE.605138',
             'SHSE.600976', 'SZSE.002562', 'SZSE.300143', 'SZSE.300566', 'SZSE.002707', 'SZSE.002438', 'SZSE.002374',
             'SHSE.603908', 'SZSE.002943', 'SHSE.601929', 'SZSE.300183', 'SZSE.000011', 'SHSE.600736', 'SZSE.002649',
             'SZSE.002455', 'SHSE.688399', 'SZSE.000040', 'SZSE.300978', 'SZSE.002354', 'SHSE.600331', 'SHSE.600391',
             'SZSE.000531', 'SHSE.603108', 'SZSE.300427', 'SHSE.605009', 'SZSE.300130', 'SZSE.002310', 'SHSE.603530',
             'SZSE.002073', 'SHSE.600681', 'SHSE.603520', 'SZSE.300480', 'SHSE.605018', 'SZSE.002284', 'SZSE.300477',
             'SHSE.600284', 'SZSE.300278', 'SHSE.688668', 'SHSE.603699', 'SZSE.300258', 'SHSE.605050', 'SZSE.002547',
             'SHSE.600545', 'SZSE.002022', 'SHSE.605388', 'SHSE.605377', 'SHSE.603569', 'SHSE.600288', 'SZSE.300196',
             'SZSE.300738', 'SHSE.603203', 'SZSE.002383', 'SZSE.002062', 'SHSE.600184', 'SZSE.002445', 'SHSE.603383',
             'SZSE.000861', 'SZSE.300790', 'SZSE.300617', 'SZSE.002611', 'SZSE.000006', 'SZSE.002915', 'SHSE.600165',
             'SZSE.300455', 'SZSE.300098', 'SHSE.600990', 'SZSE.002668', 'SZSE.002990', 'SZSE.002421', 'SZSE.300352',
             'SHSE.688368', 'SHSE.688550', 'SZSE.300091', 'SZSE.300031', 'SZSE.002346', 'SZSE.300634', 'SZSE.002109',
             'SZSE.300114', 'SZSE.002197', 'SZSE.002937', 'SZSE.000505', 'SZSE.000731', 'SHSE.600797', 'SZSE.002055',
             'SHSE.600565', 'SZSE.301149', 'SZSE.002017', 'SZSE.000666', 'SZSE.000838', 'SHSE.603982', 'SZSE.300123',
             'SHSE.603387', 'SHSE.601858', 'SHSE.605007', 'SZSE.000589', 'SZSE.300657', 'SZSE.002833', 'SZSE.300134',
             'SHSE.603078', 'SZSE.002344', 'SZSE.000056', 'SZSE.300900', 'SZSE.300705', 'SHSE.600449', 'SHSE.601199',
             'SZSE.300815', 'SZSE.000652', 'SHSE.603601', 'SZSE.002758', 'SHSE.600343', 'SZSE.003037', 'SHSE.600758',
             'SZSE.002570', 'SHSE.601700', 'SHSE.600992', 'SZSE.002636', 'SHSE.605199', 'SZSE.300981', 'SZSE.300048',
             'SZSE.000922', 'SZSE.000868', 'SZSE.000601', 'SHSE.688103', 'SHSE.600531', 'SHSE.688319', 'SZSE.300377',
             'SZSE.300842', 'SZSE.300579', 'SZSE.002042', 'SZSE.300397', 'SHSE.603848', 'SZSE.003032', 'SZSE.002327',
             'SZSE.003043', 'SZSE.002154', 'SHSE.688661', 'SZSE.000036', 'SHSE.603992', 'SHSE.688606', 'SHSE.600367',
             'SHSE.603738', 'SZSE.300708', 'SHSE.603324', 'SZSE.000948', 'SHSE.603368', 'SZSE.000965', 'SHSE.600698',
             'SHSE.603949', 'SZSE.000536', 'SZSE.002106', 'SZSE.002880', 'SHSE.605305', 'SZSE.002215', 'SZSE.300355',
             'SZSE.000099', 'SZSE.000055', 'SZSE.300680', 'SHSE.600268', 'SHSE.600983', 'SHSE.603093', 'SZSE.000905',
             'SZSE.300435', 'SZSE.002695', 'SZSE.002263', 'SZSE.002542', 'SHSE.688699', 'SHSE.600410', 'SHSE.688768',
             'SZSE.300102', 'SZSE.300673', 'SZSE.300620', 'SHSE.603018', 'SZSE.300575', 'SZSE.300303', 'SZSE.300039',
             'SHSE.603970', 'SHSE.688359', 'SZSE.301021', 'SHSE.603138', 'SHSE.600936', 'SZSE.002467', 'SHSE.688667',
             'SHSE.603208', 'SHSE.600790', 'SZSE.300324', 'SZSE.300715', 'SZSE.002641', 'SZSE.300384', 'SZSE.002478',
             'SZSE.002554', 'SHSE.600035', 'SHSE.600629', 'SZSE.002605', 'SZSE.300066', 'SZSE.002579', 'SZSE.002256',
             'SHSE.600425', 'SZSE.300007', 'SHSE.688093', 'SHSE.688158', 'SZSE.002367', 'SZSE.300648', 'SHSE.600127',
             'SZSE.000903', 'SHSE.601500', 'SZSE.002338', 'SZSE.002170', 'SZSE.002664', 'SHSE.600207', 'SZSE.300758',
             'SHSE.600650', 'SHSE.600724', 'SHSE.603359', 'SZSE.002277', 'SHSE.601008', 'SHSE.603917', 'SHSE.600658',
             'SHSE.600300', 'SZSE.300986', 'SZSE.300219', 'SHSE.600894', 'SHSE.605006', 'SZSE.300351', 'SHSE.603555',
             'SZSE.002520', 'SHSE.600103', 'SZSE.002991', 'SZSE.300656', 'SZSE.300860', 'SZSE.001208', 'SZSE.300872',
             'SZSE.002082', 'SHSE.688155', 'SZSE.002435', 'SHSE.600759', 'SHSE.688259', 'SHSE.600868', 'SZSE.000713',
             'SZSE.000815', 'SZSE.002896', 'SHSE.688595', 'SHSE.600114', 'SHSE.688280', 'SHSE.601366', 'SHSE.600227',
             'SZSE.002251', 'SZSE.002979', 'SZSE.002437', 'SZSE.300328', 'SZSE.300471', 'SHSE.600601', 'SHSE.605118',
             'SZSE.000851', 'SHSE.600590', 'SZSE.000816', 'SZSE.300505', 'SZSE.002187', 'SZSE.002640', 'SHSE.600965',
             'SZSE.002140', 'SHSE.688201', 'SZSE.002777', 'SZSE.002016', 'SHSE.605300', 'SZSE.000566', 'SZSE.002882',
             'SHSE.600071', 'SZSE.300184', 'SZSE.300951', 'SHSE.600303', 'SZSE.300809', 'SZSE.300222', 'SZSE.300916',
             'SHSE.600789', 'SHSE.605056', 'SZSE.002234', 'SHSE.603416', 'SZSE.300722', 'SZSE.300485', 'SZSE.002141',
             'SZSE.300286', 'SZSE.300801', 'SZSE.002104', 'SZSE.001205', 'SHSE.600738', 'SZSE.000863', 'SZSE.301099',
             'SHSE.605080', 'SZSE.002852', 'SZSE.002303', 'SZSE.300590', 'SZSE.300158', 'SZSE.300548', 'SHSE.601579',
             'SZSE.000523', 'SZSE.000584', 'SZSE.000576', 'SZSE.300774', 'SZSE.002672', 'SZSE.300709', 'SHSE.603931',
             'SZSE.002449', 'SZSE.002829', 'SZSE.002093', 'SHSE.600228', 'SZSE.300174', 'SZSE.000592', 'SZSE.002181',
             'SHSE.603977', 'SZSE.300181', 'SHSE.603367', 'SZSE.300271', 'SHSE.605089', 'SZSE.002483', 'SZSE.002321',
             'SZSE.002167', 'SHSE.600708', 'SHSE.603897', 'SZSE.002968', 'SHSE.603768', 'SHSE.600694', 'SZSE.300127',
             'SHSE.603031', 'SZSE.300834', 'SZSE.002885', 'SZSE.300436', 'SZSE.000993', 'SZSE.002519', 'SZSE.300607',
             'SHSE.600279', 'SZSE.300255', 'SHSE.600861', 'SZSE.300149', 'SZSE.002341', 'SZSE.300903', 'SHSE.600220',
             'SHSE.600982', 'SHSE.605060', 'SHSE.603815', 'SHSE.600815', 'SHSE.600846', 'SHSE.600686', 'SZSE.300506',
             'SZSE.000882', 'SZSE.000697', 'SHSE.603538', 'SZSE.000507', 'SZSE.002530', 'SHSE.688025', 'SZSE.000859',
             'SHSE.600880', 'SZSE.300177', 'SZSE.002785', 'SZSE.300867', 'SHSE.603823', 'SHSE.688277', 'SZSE.002803',
             'SZSE.300787', 'SZSE.300276', 'SZSE.002454', 'SZSE.300740', 'SZSE.300287', 'SHSE.600804', 'SZSE.301179',
             'SZSE.300507', 'SZSE.300365', 'SZSE.300331', 'SHSE.603408', 'SHSE.688308', 'SHSE.603002', 'SZSE.300911',
             'SZSE.002658', 'SHSE.603380', 'SHSE.603421', 'SZSE.300468', 'SZSE.002919', 'SHSE.688767', 'SHSE.600081',
             'SHSE.601010', 'SZSE.002650', 'SHSE.603309', 'SZSE.000070', 'SZSE.000797', 'SZSE.300266', 'SHSE.688077',
             'SHSE.603313', 'SZSE.300802', 'SHSE.600067', 'SHSE.603867', 'SZSE.300049', 'SZSE.300204', 'SZSE.300492',
             'SHSE.600726', 'SZSE.300859', 'SHSE.605136', 'SHSE.688182', 'SZSE.300318', 'SZSE.002662', 'SZSE.002033',
             'SZSE.002685', 'SHSE.688230', 'SHSE.600798', 'SHSE.688221', 'SHSE.600501', 'SZSE.002717', 'SHSE.688357',
             'SZSE.000949', 'SZSE.000823', 'SHSE.688211', 'SHSE.688179', 'SZSE.002553', 'SHSE.601116', 'SZSE.300793',
             'SHSE.518880', 'SZSE.159865', 'SHSE.512690', 'SZSE.159790', 'SHSE.512760', 'SZSE.159870', 'SZSE.002733',
             'SHSE.516780', 'SHSE.515210', 'SHSE.000001', 'SZSE.159929', 'SHSE.515710', 'SHSE.512290', 'SZSE.159732',
             'SHSE.513050', 'SZSE.159611', 'SHSE.510900', 'SZSE.159619', 'SZSE.159770', 'SHSE.512710', 'SHSE.512880',
             'SHSE.516360', 'SHSE.515030', 'SHSE.512660', 'SHSE.512800', 'SHSE.512400', 'SHSE.512200', 'SHSE.515790',
             'SZSE.159931', 'SHSE.588360', 'SHSE.515220', 'SHSE.516160', 'SHSE.516800', 'SHSE.516660', 'SHSE.516320',
             'SHSE.512100', 'SHSE.512480', 'SZSE.159928']

print(len(run_codes))

# 创建表
db_ex.create_tables(run_codes)

# 当前时间
now_datetime = datetime.datetime.now()

# 默认第一次同步的起始时间，后续则进行增量更新
sync_frequencys = {
    'd': {'start': '2005-01-01 00:00:00'},
    '30m': {'start': '2016-01-01 00:00:00'},
    '5m': {'start': '2016-01-01 00:00:00'},
}
# 本地周期与掘金周期对应关系
fre_maps = {
    '5m': '300s', '30m': '1800s', 'd': '1d'
}

# K线数据采用后复权，可增量更新
is_update = False
for code in tqdm(run_codes):

    # 中途终端后，可以设置下次起始的代码
    # if not is_update and code == 'SHSE.603053':
    #     is_update = True
    # if not is_update:
    #     continue

    for f, dt in sync_frequencys.items():
        try:
            while True:
                time.sleep(1)
                last_dt = db_ex.query_last_datetime(code, f)
                if last_dt is None:
                    last_dt = dt['start']
                klines = history(
                    code, fre_maps[f], start_time=last_dt, end_time=now_datetime, adjust=ADJUST_POST, df=True
                )
                klines.loc[:, 'code'] = klines['symbol']
                klines.loc[:, 'date'] = pd.to_datetime(klines['bob'])
                klines = klines[['code', 'date', 'open', 'close', 'high', 'low', 'volume']]
                print('Run code %s frequency %s klines len %s' % (code, f, len(klines)))
                db_ex.insert_klines(code, f, klines)
                if len(klines) < 100:
                    break
        except Exception as e:
            print('执行 %s 同步K线异常' % code)
            print(traceback.format_exc())
            time.sleep(10)
